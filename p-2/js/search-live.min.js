/*!
 * search-live.js
 *
 * Copyright (c) "kento" Karim Rahimpur www.itthinx.com
 *
 * This code is released under the GNU General Public License.
 * See COPYRIGHT.txt and LICENSE.txt.
 *
 * This code is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * This header and all notices must be kept intact.
 *
 * @author itthinx
 * @package search-live
 * @since 1.0.0
 */
var ixsl={doPost:!0,blinkerTimeouts:[],blinkerTimeout:5e3};!function(e){ixsl.inhibitEnter=function(t){e("#"+t).keydown((function(e){if(13==e.keyCode)return e.preventDefault(),!1}))},ixsl.dynamicFocus=function(t,i){var n=e("#"+t),l=e("#"+i);n.focusout((function(t){var i=e(this);setTimeout((function(){i.find(":focus").length>0||l.hide()}),162)})),n.focusin((function(t){var i=e(this).find("input.search-live-field");i.length>0&&0==e(i[0]).val().length&&l.html(""),l.show()}))},ixsl.navigate=function(t,i){e("#"+t).keydown((function(t){var n=0,l=!1,s=!1;switch(t.keyCode){case 37:case 39:break;case 38:n=-1;break;case 40:n=1;break;case 13:l=!0;break;case 27:s=!0}if(0!=n){var a=e("#"+i).find(".entry"),r=e("#"+i+" .entry.active").index();return a.length>0&&(r>=0&&e(a[r]).removeClass("active"),(r+=n)<0?r=a.length-1:r>=a.length&&(r=0),e(a[r]).addClass("active")),t.preventDefault(),!1}if(l){a=e("#"+i).find(".entry");if((r=e("#"+i+" .entry.active").index())>=0&&r<a.length){var o=e(a[r]).find("a").get(0);if(void 0!==o){var u=e(o).attr("href");if(void 0!==u)return t.preventDefault(),ixsl.doPost=!1,document.location=u,!1}}}if(s){a=e("#"+i).find(".entry"),r=e("#"+i+" .entry.active").index();return a.length>0&&r>=0&&e(a[r]).removeClass("active"),t.preventDefault(),!1}}))},ixsl.searchLive=function(t,i,n,l,s,a){if(ixsl.doPost){void 0===a&&(a={});var r=e("#"+n),o=e("#"+t),u=ixsl.blinkerTimeout;if(void 0!==a.blinkerTimeout&&(u=a.blinkerTimeout),""!=(s=e.trim(s))){o.addClass("blinker"),u>0&&(ixsl.blinkerTimeouts["#"+t]=setTimeout((function(){o.removeClass("blinker")}),u));var c={action:"search_live","search-live":1,"search-live-query":s};void 0!==a.lang&&(c.lang=a.lang),e.post(l,c,(function(e){var i="";if(null!==e&&e.length>0){var l=null,s=null,c=!0,h=!1;for(var d in void 0!==a.thumbnails&&(c=a.thumbnails),void 0!==a.show_description&&(h=a.show_description),i+='<table class="search-results">',e){var v="";if(s!=e[d].type&&(s=e[d].type,v="first"),l!=e[d].result_type&&(l=e[d].result_type),i+='<tr class="entry '+e[d].result_type+" "+e[d].type+" "+v+'">',c){if(i+='<td class="result-image">',i+='<a href="'+e[d].url+'" title="'+e[d].title+'">',void 0!==e[d].thumbnail){var f="",m="",b="";void 0!==e[d].thumbnail_alt&&(b=' alt="'+e[d].thumbnail_alt+'" '),void 0!==e[d].thumbnail_width&&(f=' width="'+e[d].thumbnail_width+'" '),void 0!==e[d].thumbnail_height&&(m=' height="'+e[d].thumbnail_height+'" '),i+='<img class="thumbnail" src="'+e[d].thumbnail+'" '+b+f+m+"/>"}i+="</a>",i+="</td>"}i+='<td class="result-info">',i+='<a href="'+e[d].url+'" title="'+e[d].title+'">',i+='<span class="title">'+e[d].title+"</span>",h&&void 0!==e[d].description&&(i+='<span class="description">'+e[d].description+"</span>"),i+="</a>",i+="</td>",i+="</tr>"}i+="</table>"}else void 0!==a.no_results&&a.no_results.length>0&&(i+='<div class="no-results">',i+=a.no_results,i+="</div>");r.show().html(i),ixsl.clickable(n),o.removeClass("blinker"),u>0&&clearTimeout(ixsl.blinkerTimeouts["#"+t])}),"json")}else r.hide().html("")}},ixsl.clickable=function(t){e("#"+t+" table.search-results tr").click((function(){var t=e(this).find("a").attr("href");t&&(window.location=t)})),e("#"+t+" table.search-results tr").css("cursor","pointer")}}(jQuery);